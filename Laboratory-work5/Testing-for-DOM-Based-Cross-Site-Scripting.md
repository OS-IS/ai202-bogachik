# Тестування міжсайтового сценарію на основі DOM

|ID|
|:---:|
|WSTG-CLNT-01|

## Конспект

Міжсайтовий сценарій на основі DOM — це фактична назва помилок XSS, які є результатом активного вмісту на стороні браузера на сторінці, як правило, JavaScript, отримання введених даних користувача через джерело та використання їх у приймачі, що призводить до виконання введеного коду. У цьому документі розглядаються лише помилки JavaScript, які призводять до XSS.

DOM, або об’єктна модель документа, — це структурний формат, який використовується для представлення документів у браузері. DOM дозволяє динамічним сценаріям, таким як JavaScript, посилатися на такі компоненти документа, як поле форми або сеансовий файл cookie. DOM також використовується браузером для безпеки - наприклад, щоб обмежити сценарії в різних доменах від отримання файлів cookie сеансу для інших доменів. Уразливість XSS на основі DOM може виникнути, коли активний вміст, як-от функція JavaScript, змінюється спеціально створеним запитом, щоб елемент DOM міг контролювати зловмисник.

Не всі помилки XSS вимагають від зловмисника контролю над вмістом, що повертається із сервера, але натомість він може зловживати поганими методами кодування JavaScript для досягнення тих самих результатів. Наслідки такі ж, як і типовий недолік XSS, тільки засоби доставки відрізняються.

У порівнянні з іншими типами вразливостей міжсайтових сценаріїв (відображених і збережених, коли сервер передає необроблений параметр, а потім повертає користувачеві та виконується в контексті веб-переглядача користувача), уразливість XSS на основі DOM контролює потік коду за допомогою елементів об’єктної моделі документа (DOM) разом із кодом, створеним зловмисником для зміни потоку.

Через свою природу XSS-уразливості на основі DOM можуть бути виконані в багатьох випадках без можливості сервера визначити, що насправді виконується. Це може зробити багато загальних методів фільтрації та виявлення XSS неефективними для таких атак.

У цьому гіпотетичному прикладі використовується наступний клієнтський код:

> `<script> document.write("Site is at: " + document.location.href + "."); </script>`
